LAMMPS (11 Feb 2026 - Development - patch_11Feb2026-11-gd97c5bdda6)
  using 12 OpenMP thread(s) per MPI task
# ─────────────────────────────────────────────────────────────────────────────
# MB-pol NVT equilibration
# 216 H2O  |  18.6258 × 18.6258 × 55.8775 Å
# Generated by mbx-water-slab-prep / gen_input.py
#
# IMPORTANT — this is an unequilibrated Packmol structure.
# Run for at least 1–2 ns before collecting any production data.
# Adjust EQUIL_STEPS below to extend the run if needed.
#
# Requires mbx.json in the same directory (also generated by this tool).
# ─────────────────────────────────────────────────────────────────────────────

units           real
atom_style      full
boundary        p p p
processors      * * * map xyz

read_data       water_slab_216H2O_rho1.0_z3x.data
Reading data file ...
  orthogonal box = (0 0 0) to (18.625835 18.625835 55.877505)
  1 by 1 by 4 MPI processor grid
  reading atoms ...
  648 atoms
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  orthogonal box = (0 0 0) to (18.625835 18.625835 55.877505)
  1 by 1 by 4 MPI processor grid
  reading bonds ...
  432 bonds
  reading angles ...
  216 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     1 = max # of 1-3 neighbors
     1 = max # of 1-4 neighbors
     2 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.009 seconds

pair_style      mbx 9.0
pair_coeff      * * 1 h2o 1 2 2 json mbx.json

# MBX handles all intra- and inter-molecular interactions.
# Bond/angle sections are present for special-bond exclusions only.
bond_style      none
angle_style     none

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check yes

timestep        0.2        # fs

# ── Step 1: Energy minimisation ───────────────────────────────────────────────
# Relaxes residual close contacts from Packmol so that the MBX induced-dipole
# CG solver converges on the very first dynamics step.  The stopping criterion
# is loose — we only need the geometry to be free of catastrophic overlaps.

minimize        1.0e-4 1.0e-6 500 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair mbx command:

@article{10.1063/5.0156036,
 author = {Riera, Marc and Knight, Christopher and Bull-Vulpe, Ethan F. and Zhu, Xuanyu and Agnew, Henry and Smith, Daniel G. A. and Simmonett, Andrew C. and Paesani, Francesco},
 title = "{MBX: A many-body energy and force calculator for data-driven many-body simulations}",
 journal = {The Journal of Chemical Physics},
 volume = {159},
 number = {5},
 pages = {054802},
 year = {2023},
 doi = {10.1063/5.0156036},
 version = {1.3.5}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Bonds are defined but no bond style is set (src/force.cpp:198)
WARNING: Likewise 1-2 special neighbor interactions != 1.0 (src/force.cpp:200)
WARNING: Angles are defined but no angle style is set (src/force.cpp:203)
WARNING: Likewise 1-3 special neighbor interactions != 1.0 (src/force.cpp:205)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 4 4 11
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair mbx, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 17.56 | 17.92 | 18.28 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              1440.887       0              1440.887      -5867.6534    
       203   0             -2461.1346      0             -2461.1346     -487.56943    
Loop time of 39.2464 on 48 procs for 203 steps with 648 atoms

838.1% CPU use with 4 MPI tasks x 12 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
      1440.88701627578  -2460.91816621607  -2461.13457829664
  Force two-norm initial, final = 1323.9453 18.655499
  Force max component initial, final = 96.657097 3.3190311
  Final line search alpha, max atom move = 0.014265228 0.047346734
  Iterations, force evaluations = 203 390

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 37.265     | 38.098     | 38.992     |  13.5 | 97.07
Bond    | 6.5964e-05 | 7.4182e-05 | 8.4685e-05 |   0.0 |  0.00
Neigh   | 0.00011129 | 0.0057373  | 0.015512   |   8.4 |  0.01
Comm    | 0.012201   | 0.062861   | 0.17584    |  26.5 |  0.16
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0.16517    | 0.1772     | 0.19385    |   2.8 |  0.45
Other   |            | 0.9027     |            |       |  2.30

Nlocal:            162 ave         337 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1930 ave        2838 max        1012 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          36876 ave       92581 max           0 min
Histogram: 2 0 0 0 0 1 0 0 0 1

Total # of neighbors = 147504
Ave neighs/atom = 227.62963
Ave special neighs/atom = 2
Neighbor list builds = 7
Dangerous builds = 0
reset_timestep  0

# ── Step 2: NVT equilibration ─────────────────────────────────────────────────
variable        T      equal  298.15
variable        Tdamp  equal  20.0   # ~100 × timestep (standard for MB-pol)
variable        EQUIL_STEPS equal 5000

thermo_style    custom step temp pe ke etotal press density cpu cpuremain
thermo          1000

dump            traj all custom 5000 traj_equil.lammpstrj                 id mol type x y z xu yu zu vx vy vz
dump_modify     traj sort id flush yes

# Rolling restart pair — allows resuming from the most recent checkpoint
restart         50000 restart_equil.a restart_equil.b

fix             1 all nvt temp ${T} ${T} ${Tdamp}
fix             1 all nvt temp 298.15 ${T} ${Tdamp}
fix             1 all nvt temp 298.15 298.15 ${Tdamp}
fix             1 all nvt temp 298.15 298.15 20

run             ${EQUIL_STEPS}
run             5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Bonds are defined but no bond style is set (src/force.cpp:198)
WARNING: Likewise 1-2 special neighbor interactions != 1.0 (src/force.cpp:200)
WARNING: Angles are defined but no angle style is set (src/force.cpp:203)
WARNING: Likewise 1-3 special neighbor interactions != 1.0 (src/force.cpp:205)
Per MPI rank memory allocation (min/avg/max) = 16.45 | 16.81 | 17.17 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press         Density          CPU          CPULeft    
         0   0             -2461.1346      0             -2461.1346     -487.56943      0.3333307      0              0            
      1000   266.06429     -2354.284       513.12736     -1841.1567      1445.8151      0.3333307      100.28297      401.13186    
      2000   298.91937     -1992.927       576.49114     -1416.4359      965.43442      0.3333307      197.19489      295.79234    
      3000   309.15181     -1820.8224      596.22527     -1224.5971     -220.26805      0.3333307      287.384        191.58934    
      4000   313.06735     -1713.4599      603.77671     -1109.6832     -484.45679      0.3333307      370.92863      92.732157    
      5000   291.49289     -1627.4192      562.16855     -1065.2506     -620.62924      0.3333307      449.76043      0            
Loop time of 449.782 on 48 procs for 5000 steps with 648 atoms

Performance: 0.192 ns/day, 124.939 hours/ns, 11.116 timesteps/s, 7.203 katom-step/s
855.9% CPU use with 4 MPI tasks x 12 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 426.91     | 436.53     | 446.79     |  45.7 | 97.05
Bond    | 0.0006481  | 0.00070614 | 0.00075469 |   0.0 |  0.00
Neigh   | 0.00063367 | 0.034288   | 0.090609   |  20.1 |  0.01
Comm    | 0.52465    | 3.0154     | 6.0449     | 117.6 |  0.67
Output  | 0.021915   | 0.022003   | 0.02211    |   0.0 |  0.00
Modify  | 2.2877     | 10.129     | 19.29      | 247.2 |  2.25
Other   |            | 0.04754    |            |       |  0.01

Nlocal:            162 ave         327 max           5 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1894 ave        2658 max        1127 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:        28544.5 ave       65999 max          74 min
Histogram: 2 0 0 0 0 0 0 1 0 1

Total # of neighbors = 114178
Ave neighs/atom = 176.20062
Ave special neighs/atom = 2
Neighbor list builds = 44
Dangerous builds = 0

# ── Finalise ──────────────────────────────────────────────────────────────────
unfix           1
undump          traj
write_data      equil_final.data
System init for write_data ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Bonds are defined but no bond style is set (src/force.cpp:198)
WARNING: Likewise 1-2 special neighbor interactions != 1.0 (src/force.cpp:200)
WARNING: Angles are defined but no angle style is set (src/force.cpp:203)
WARNING: Likewise 1-3 special neighbor interactions != 1.0 (src/force.cpp:205)
Total wall time: 0:08:09
