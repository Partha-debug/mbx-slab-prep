LAMMPS (11 Feb 2026 - Development - patch_11Feb2026-11-gd97c5bdda6)
  using 12 OpenMP thread(s) per MPI task
# ─────────────────────────────────────────────────────────────────────────────
# MB-pol NVT equilibration
# 64 H2O  |  12.4172 × 12.4172 × 37.2517 Å
# Generated by mbx-water-slab-prep / gen_input.py
#
# IMPORTANT — this is an unequilibrated Packmol structure.
# Run for at least 1–2 ns before collecting any production data.
# Adjust EQUIL_STEPS below to extend the run if needed.
#
# Requires mbx.json in the same directory (also generated by this tool).
# ─────────────────────────────────────────────────────────────────────────────

units           real
atom_style      full
boundary        p p p
processors      * * * map xyz

read_data       water_slab_64H2O_rho1.0_z3x.data
Reading data file ...
  orthogonal box = (0 0 0) to (12.417223 12.417223 37.251669)
  1 by 1 by 4 MPI processor grid
  reading atoms ...
  192 atoms
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  orthogonal box = (0 0 0) to (12.417223 12.417223 37.251669)
  1 by 1 by 4 MPI processor grid
  reading bonds ...
  128 bonds
  reading angles ...
  64 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     1 = max # of 1-3 neighbors
     1 = max # of 1-4 neighbors
     2 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.007 seconds

pair_style      mbx 9.0
pair_coeff      * * 1 h2o 1 2 2 json mbx.json

# MBX handles all intra- and inter-molecular interactions.
# Bond/angle sections are present for special-bond exclusions only.
bond_style      none
angle_style     none

neighbor        2.0 bin
neigh_modify    every 1 delay 0 check yes

timestep        0.2        # fs

# ── Step 1: Energy minimisation ───────────────────────────────────────────────
# Relaxes residual close contacts from Packmol so that the MBX induced-dipole
# CG solver converges on the very first dynamics step.  The stopping criterion
# is loose — we only need the geometry to be free of catastrophic overlaps.

minimize        1.0e-4 1.0e-6 500 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair mbx command:

@article{10.1063/5.0156036,
 author = {Riera, Marc and Knight, Christopher and Bull-Vulpe, Ethan F. and Zhu, Xuanyu and Agnew, Henry and Smith, Daniel G. A. and Simmonett, Andrew C. and Paesani, Francesco},
 title = "{MBX: A many-body energy and force calculator for data-driven many-body simulations}",
 journal = {The Journal of Chemical Physics},
 volume = {159},
 number = {5},
 pages = {054802},
 year = {2023},
 doi = {10.1063/5.0156036},
 version = {1.3.5}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Bonds are defined but no bond style is set (src/force.cpp:198)
WARNING: Likewise 1-2 special neighbor interactions != 1.0 (src/force.cpp:200)
WARNING: Angles are defined but no angle style is set (src/force.cpp:203)
WARNING: Likewise 1-3 special neighbor interactions != 1.0 (src/force.cpp:205)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 11
  ghost atom cutoff = 11
  binsize = 5.5, bins = 3 3 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair mbx, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 17.47 | 17.66 | 17.82 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              478.0358       0              478.0358      -5594.1438    
       195   0             -727.11013      0             -727.11013     -340.88433    
Loop time of 15.4622 on 48 procs for 195 steps with 192 atoms

886.8% CPU use with 4 MPI tasks x 12 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
       478.03580128551  -727.039385536753  -727.110125988405
  Force two-norm initial, final = 715.09351 11.710216
  Force max component initial, final = 91.97403 3.3360884
  Final line search alpha, max atom move = 0.021967983 0.073287134
  Iterations, force evaluations = 195 383

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 14.895     | 15.106     | 15.334     |   5.2 | 97.70
Bond    | 3.8705e-05 | 4.4894e-05 | 5.1231e-05 |   0.0 |  0.00
Neigh   | 7.655e-05  | 0.0010989  | 0.0028462  |   3.4 |  0.01
Comm    | 0.014092   | 0.035059   | 0.085681   |  15.8 |  0.23
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0.084275   | 0.088261   | 0.095352   |   1.5 |  0.57
Other   |            | 0.2316     |            |       |  1.50

Nlocal:             48 ave         101 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:         1223.5 ave        1444 max         952 min
Histogram: 1 0 1 0 0 0 0 0 0 2
Neighs:           9297 ave       25423 max           0 min
Histogram: 2 0 0 0 1 0 0 0 0 1

Total # of neighbors = 37188
Ave neighs/atom = 193.6875
Ave special neighs/atom = 2
Neighbor list builds = 6
Dangerous builds = 0
reset_timestep  0

# ── Step 2: NVT equilibration ─────────────────────────────────────────────────
variable        T      equal  298.15
variable        Tdamp  equal  20.0   # ~100 × timestep (standard for MB-pol)
variable        EQUIL_STEPS equal 5000

thermo_style    custom step temp pe ke etotal press density cpu cpuremain
thermo          1000

dump            traj all custom 5000 traj_equil.lammpstrj                 id mol type x y z xu yu zu vx vy vz
dump_modify     traj sort id flush yes

# Rolling restart pair — allows resuming from the most recent checkpoint
restart         50000 restart_equil.a restart_equil.b

fix             1 all nvt temp ${T} ${T} ${Tdamp}
fix             1 all nvt temp 298.15 ${T} ${Tdamp}
fix             1 all nvt temp 298.15 298.15 ${Tdamp}
fix             1 all nvt temp 298.15 298.15 20

run             ${EQUIL_STEPS}
run             5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Bonds are defined but no bond style is set (src/force.cpp:198)
WARNING: Likewise 1-2 special neighbor interactions != 1.0 (src/force.cpp:200)
WARNING: Angles are defined but no angle style is set (src/force.cpp:203)
WARNING: Likewise 1-3 special neighbor interactions != 1.0 (src/force.cpp:205)
Per MPI rank memory allocation (min/avg/max) = 16.36 | 16.56 | 16.71 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press         Density          CPU          CPULeft    
         0   0             -727.11013      0             -727.11013     -340.88433      0.33333073     0              0            
      1000   299.07341     -631.33109      170.27287     -461.05821      1905.9477      0.33333073     39.546996      158.18799    
      2000   283.40397     -535.6136       161.35172     -374.26188     -923.44355      0.33333073     77.033462      115.55019    
      3000   313.61816     -475.1602       178.55371     -296.60649      636.72616      0.33333073     113.27391      75.515943    
      4000   286.83724     -457.02183      163.3064      -293.71543      110.41188      0.33333073     149.03199      37.257996    
      5000   280.50772     -454.41276      159.70278     -294.70998     -1000.4865      0.33333073     183.84954      0            
Loop time of 183.853 on 48 procs for 5000 steps with 192 atoms

Performance: 0.470 ns/day, 51.070 hours/ns, 27.196 timesteps/s, 5.222 katom-step/s
915.9% CPU use with 4 MPI tasks x 12 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 176.9      | 179.45     | 182.1      |  17.7 | 97.60
Bond    | 0.00048537 | 0.00053472 | 0.00058532 |   0.0 |  0.00
Neigh   | 0.00053267 | 0.0072035  | 0.017344   |   8.2 |  0.00
Comm    | 0.20211    | 0.95983    | 2.3706     |  88.2 |  0.52
Output  | 0.0004207  | 0.0025932  | 0.0033852  |   2.5 |  0.00
Modify  | 1.3546     | 3.4084     | 6.3274     | 115.2 |  1.85
Other   |            | 0.02589    |            |       |  0.01

Nlocal:             48 ave         113 max           0 min
Histogram: 2 0 0 0 0 0 1 0 0 1
Nghost:         1213.5 ave        1452 max         912 min
Histogram: 1 0 0 0 1 0 0 0 1 1
Neighs:        6912.75 ave       13757 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 27651
Ave neighs/atom = 144.01562
Ave special neighs/atom = 2
Neighbor list builds = 40
Dangerous builds = 0

# ── Finalise ──────────────────────────────────────────────────────────────────
unfix           1
undump          traj
write_data      equil_final.data
System init for write_data ...
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
WARNING: Bonds are defined but no bond style is set (src/force.cpp:198)
WARNING: Likewise 1-2 special neighbor interactions != 1.0 (src/force.cpp:200)
WARNING: Angles are defined but no angle style is set (src/force.cpp:203)
WARNING: Likewise 1-3 special neighbor interactions != 1.0 (src/force.cpp:205)
Total wall time: 0:03:19
